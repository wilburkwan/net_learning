from jubollm.nCopilot.generator.base_response_generator import BaseResponseGenerator


class NisResponseGenerator(BaseResponseGenerator):
    def _construct_patch_mappings(self, user_input, query_result, collection_name):
        if collection_name == 'patients_info':
            from jubollm.nCopilot.generator.prompts.nis_orgchat_patients import BASIC_PROMPT_RESPONSE, TOOLS_RESPONSE
        else:
            from jubollm.nCopilot.generator.prompts.nis_orgchat_vitalsigns import BASIC_PROMPT_RESPONSE, TOOLS_RESPONSE

        db_output = [doc for doc in query_result if 'link' not in doc]
        link = next((doc['link'] for doc in query_result if 'link' in doc), None)

        return {
            'tool2': TOOLS_RESPONSE,
            'user_input': user_input,
            'db_output': db_output,
            'link': link,
            'base_prompt': BASIC_PROMPT_RESPONSE
        }
