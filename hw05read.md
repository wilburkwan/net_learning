

***

# 午餐／聚會決策器 Lunch/Group Decision Helper

## 簡介

本專案是一個基於 Google Sheets + Gemini AI API 的命令列互動式餐廳建議系統，能根據價位、距離、營業狀態等條件，從雲端餐廳清單自動篩選合適店家，並隨機推薦三家，輔以 AI 100字摘要協助快速決策。同時可將推薦建議自動寫入 Google Sheets「建議清單」。

***

## 主要功能

- **Google Sheets連線**：自動串接遠端餐廳資料與推薦寫回。
- **多條件篩選**：依「價位」、「最大距離」、「是否營業」三條件過濾餐廳。
- **隨機推薦**：從過濾後清單挑選三家餐廳。
- **Gemini AI摘要**：快速給出三家餐廳優缺點/建議（100字內）。
- **建議記錄寫回**：將本次建議自動保存到Sheets「建議清單」。
- **資料自動偵錯**：自動判斷原始資料格式，若發現關鍵欄位空白會提示修正。

***

## 安裝與執行方式

### 環境需求

- Python 3.x
- Google Colab 或支援 gspread、google-auth、google-generativeai 的本地環境
- 有Google帳號權限可編輯你指定的 Google Sheet

### 套件需求

程式會自動安裝所需套件：
- streamlit
- gspread
- pandas
- plotly
- google-generativeai

### 步驟說明

1. **複製程式碼到 Colab 或你自己的 Notebook 執行環境（`.py`也可）**
2. 首次執行時請授權 Google Drive（Colab 會自動彈窗要求登入）
3. 須確認 Google Sheets 內「餐廳清單」已有正確欄位及資料（見下方範例）。
4. 執行程式後依 CLI 指示逐步輸入條件即可產生今日推薦建議。

***

## Google Sheets資料格式

### 餐廳清單工作表（欄位必須為下列/對應）

| 餐廳       | 價位 | 距離 | 是否營業 | 推薦菜 | 特色 |  ...（可自訂額外欄位）|
|:-----------|:----:|:----:|:--------:|:------:|:----:|:--------------------:|
| 老張牛肉麵 | 180  | 1.2  | 是       | 牛肉麵 | 湯頭濃郁               |
| ...        | ...  | ...  | ...      | ...    | ...                    |

#### 「距離」一定要為數字，勿留空或文字！

### 建議清單工作表（自動建立/寫入）

| 產生時間             | 推薦餐廳                 | AI摘要           |
|:--------------------:|:-----------------------:|:----------------:|
| 2025-09-25 12:00     | 老張牛肉麵；港式茶餐廳...| AI精簡建議       |

***

## 執行流程截圖（示意）

```
✅ Google Sheet連線成功

[請輸入篩選條件，直接Enter則不限制]
價位區間（例: 100~250，或直接Enter略過）: 100~200
最大距離（km，例：2，或Enter略過）: 2
只選取目前有營業的？(y/n/Enter): y

🎲 推薦餐廳：
餐廳: 老張牛肉麵 | 價位: 180 | 距離: 1.2 | ...
餐廳: 港式茶餐廳 | 價位: 150 | 距離: 1.8 | ...
餐廳: 素食餐廳   | 價位: 160 | 距離: 1.1 | ...
Gemini建議：牛肉麵湯頭濃、素食有健康選項，港式茶點輕鬆聚會，合理價位、好交通，適合快速午餐或團體用餐。
✅ 已寫入建議清單。
```

***
