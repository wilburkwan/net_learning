
***

# 番茄鐘＋ToDo任務管理系統（Colab + Gemini AI）

這是一個基於 Google Sheet 的「番茄鐘＋待辦清單（To-do）」行動計畫管理工具，支援任務規劃、自動分割時段（早/午/晚）、進度追蹤，並結合 Gemini AI 給出專業的智能建議！**適合個人自我管理與效率提升。**

***

## 🏗 特色功能

- Google Sheet 雲端資料，任務隨時新增/查詢/更新
- 支援欄位：「任務」、「狀態」、「預估時間」、「實際完成時間」、「番茄鐘數」、「完成時段」
- 以 CLI（Colab命令列）快速錄入與更新每日任務
- Gemini AI 自動協助你依早/午/晚分段分配任務、行動建議
- 進度統計，可即時查詢完成率與已完成度

***

## 🚀 快速安裝

1. 打開 Google Colab 新增 Python 3 Notebook
2. 複製並貼上下方程式碼全段於 Colab Cell 執行  
   （程式碼請見 main.py 或本README下方 **完整範例**）
3. 依提示連接 Google 帳號（首次使用需授權）
4. 按下指令選單即可開始管理您的待辦計劃！

***
# Google Colab 使用指南

## 🚀 快速開始

### 1. 在 Colab 中執行程式

```python
# 1. 安裝必要套件
!pip install gspread pandas google-generativeai seaborn matplotlib gradio

# 2. 執行程式
!python hw03.py
```

### 2. 開啟 Gradio 介面

程式執行後會顯示兩個 URL：
- **Local URL**: 例如 `http://127.0.0.1:7860`
- **Public URL**: 例如 `https://xxxxx.gradio.live`

**在 Colab 中請點擊 Public URL！**

---

## 📤 匯出功能詳細說明

### 方法一：使用 GUI 匯出（推薦）

1. **開啟 Gradio 介面**
   - 點擊 Public URL 連結

2. **切換到「🔍 查詢與匯出」標籤**

3. **選擇匯出格式**
   - CSV：適合用 Excel 開啟
   - JSON：適合程式處理

4. **點擊「📤 匯出資料」按鈕**

5. **下載檔案**
   - 匯出成功後，會在「下載檔案」區域顯示檔案
   - **直接點擊檔案名稱**即可下載到您的電腦
   - 檔案會儲存在您的瀏覽器下載資料夾

### 方法二：從 Colab 檔案管理員下載

如果 GUI 下載失敗，可以使用此方法：

1. **點擊 Colab 左側的資料夾圖示** 📁

2. **找到匯出的檔案**
   - 檔案名稱：`tasks_export_20241009.csv` 或 `.json`

3. **右鍵點擊檔案** → 選擇「下載」

4. **檢查瀏覽器下載資料夾**

### 方法三：使用 Python 代碼強制下載

如果上述方法都不行，在 Colab 新的 cell 中執行：

```python
from google.colab import files

# 下載 CSV 檔案
files.download('tasks_export_20241009.csv')

# 或下載 JSON 檔案
files.download('tasks_export_20241009.json')
```

---

## 📥 匯入功能詳細說明

### 步驟一：準備要匯入的檔案

確保檔案格式正確：

**CSV 格式範例**：
```csv
任務,狀態,預估時間,實際完成時間,番茄鐘數,完成時段,完成日期
完成作業,已完成,60,55,2,morning,2024-10-09
準備報告,未完成,90,,,
```

**JSON 格式範例**：
```json
[
  {
    "任務": "完成作業",
    "狀態": "已完成",
    "預估時間": "60",
    "實際完成時間": "55",
    "番茄鐘數": "2",
    "完成時段": "morning",
    "完成日期": "2024-10-09"
  }
]
```

### 步驟二：上傳並匯入

1. **開啟 Gradio 介面**（Public URL）

2. **切換到「🔍 查詢與匯出」標籤**

3. **在「資料匯入」區域**
   - 點擊「上傳檔案」按鈕
   - 選擇您的 CSV 或 JSON 檔案
   - 檔案會上傳到 Colab

4. **點擊「📥 匯入資料」按鈕**

5. **檢查結果**
   - 匯入狀態會顯示成功訊息
   - 下方會顯示合併後的任務列表
   - 資料會自動同步到 Google Sheets

### 驗證匯入是否成功

1. **切換到「📝 任務管理」標籤**
2. **檢查任務列表**是否包含匯入的資料
3. **開啟 Google Sheets**，確認資料已同步

---

## 🔍 檔案格式檢查

### CSV 檔案必須包含以下欄位：
- 任務
- 狀態
- 預估時間
- 實際完成時間
- 番茄鐘數
- 完成時段
- 完成日期

### JSON 檔案格式：
- 必須是 JSON 陣列 `[ ... ]`
- 每個物件包含上述所有欄位
- 使用繁體中文欄位名稱

### 常見錯誤：

❌ **錯誤 1：欄位名稱不符**
```csv
Task,Status,Time  # 錯誤！應該用中文欄位名
```

✅ **正確**：
```csv
任務,狀態,預估時間,實際完成時間,番茄鐘數,完成時段,完成日期
```

❌ **錯誤 2：JSON 格式錯誤**
```json
{  // 錯誤！最外層應該是陣列
  "任務": "測試"
}
```

✅ **正確**：
```json
[  // 最外層是陣列
  {
    "任務": "測試",
    "狀態": "未完成",
    ...
  }
]
```

---

## 🎯 完整測試流程

### 測試匯出功能

1. **新增一些測試任務**
   - 在「📝 任務管理」標籤新增 2-3 個任務

2. **標記其中一個完成**
   - 在「✔️ 標記完成」標籤完成一個任務

3. **匯出 CSV 檔案**
   - 在「🔍 查詢與匯出」標籤匯出為 CSV
   - 下載檔案並用 Excel 或文字編輯器開啟檢查

4. **匯出 JSON 檔案**
   - 匯出為 JSON
   - 下載檔案並檢查格式

### 測試匯入功能

1. **修改匯出的檔案**
   - 用 Excel 或文字編輯器開啟
   - 新增一個任務：
     ```csv
     測試匯入任務,未完成,30,,,
     ```

2. **上傳並匯入**
   - 在「🔍 查詢與匯出」標籤上傳修改後的檔案
   - 點擊「📥 匯入資料」

3. **驗證結果**
   - 檢查「任務管理」標籤，應該看到新增的任務
   - 開啟 Google Sheets，確認同步成功

---

## ⚠️ 常見問題

### Q1: 點擊匯出後沒有下載檔案？

**解決方法**：
1. 檢查「下載檔案」區域是否顯示檔案
2. 直接點擊檔案名稱下載
3. 或使用 Colab 左側檔案管理員手動下載
4. 檢查瀏覽器是否阻擋彈出視窗

### Q2: 匯入時顯示「找不到檔案」？

**解決方法**：
1. 確認已點擊「上傳檔案」並選擇檔案
2. 等待檔案上傳完成（會顯示檔案名稱）
3. 再點擊「📥 匯入資料」按鈕

### Q3: 匯入後顯示「檔案格式不符」？

**解決方法**：
1. 檢查 CSV/JSON 檔案是否包含所有必要欄位
2. 確認欄位名稱使用繁體中文
3. 使用提供的範例檔案作為參考：
   - `tasks_export_example.csv`
   - `tasks_export_example.json`

### Q4: 匯出的檔案在哪裡？

**位置**：
- **Colab 環境**：
  - 左側檔案管理員（📁 圖示）
  - 專案根目錄下
  - 檔案名稱：`tasks_export_YYYYMMDD.csv/json`

### Q5: 可以同時匯出 CSV 和 JSON 嗎？

**可以**：
1. 先選擇 CSV 格式，點擊匯出，下載檔案
2. 再選擇 JSON 格式，點擊匯出，下載檔案
3. 兩個檔案會有相同日期的檔名

---

## 📝 範例：完整的匯出匯入流程

### 情境：備份現有資料，修改後重新匯入

```python
# 步驟 1：在 Colab 執行程式
!python hw03.py

# 步驟 2：開啟 Public URL

# 步驟 3：新增一些任務（使用 GUI）
# - 任務 A：寫程式作業，60分鐘
# - 任務 B：準備報告，90分鐘

# 步驟 4：匯出資料
# - 切換到「🔍 查詢與匯出」標籤
# - 選擇 CSV 格式
# - 點擊「📤 匯出資料」
# - 下載檔案：tasks_export_20241009.csv

# 步驟 5：修改檔案（在本地電腦）
# - 用 Excel 開啟 CSV 檔案
# - 新增一行：任務 C：閱讀論文，45,,,
# - 儲存檔案

# 步驟 6：重新匯入
# - 在 GUI 的「資料匯入」區域上傳修改後的檔案
# - 點擊「📥 匯入資料」
# - 檢查匯入狀態

# 步驟 7：驗證
# - 切換到「📝 任務管理」標籤
# - 確認任務 C 已經出現
# - 開啟 Google Sheets 確認同步
```

---

## 🎉 成功指標

✅ **匯出成功**：
- 顯示「✅ 資料已匯出為 tasks_export_YYYYMMDD.csv」
- 「下載檔案」區域顯示檔案
- 可以成功下載並開啟檔案
- 檔案包含所有任務資料

✅ **匯入成功**：
- 顯示「✅ 已成功從 XXX 匯入並合併任務！」
- 「匯入後的任務列表」顯示合併後的資料
- 在「任務管理」標籤可以看到匯入的任務
- Google Sheets 已同步新資料

---

## 💡 提示

1. **定期備份**：建議每天匯出一次資料作為備份
2. **使用 Git**：將匯出的檔案加入 Git 版本控制
3. **檢查格式**：匯入前先用文字編輯器檢查檔案格式
4. **測試小檔案**：第一次匯入時先用少量資料測試

---

**需要更多協助？**

- 查看範例檔案：`tasks_export_example.csv` 和 `tasks_export_example.json`
- 參考主要說明：[README.md](./README.md)
- 快速啟動指南：[QUICK_START.md](./QUICK_START.md)

**祝您使用順利！** 🎉

